# Logging in a Simple python3 Lambda Function

## Default Lambda Logging

We will start by creating a very simple function that generates a random number between 1 and 100 to highlight how log information is emitted and stored. AWS Lambda functions can send log data to Cloudwatch Logs log group and log streams for each instance of your function.

Using the following commands, you can build and run the function locally.

```bash
cd simple-function/non_logging
sam build --use-container
sam local invoke 
```

The function emits the following log entries.

**NOTE:** Your ouput is representative - your output will differ.

```bash
simple-function % sam local invoke                           
Invoking index.handler (python3.9)
Skip pulling image and use local one: public.ecr.aws/sam/emulation-python3.9:rapid-1.53.0-x86_64.

Mounting /path/to/lambda-logging-primer/simple-function/non_logging/.aws-sam/build/NonLoggingFunction as /var/task:ro,delegated inside runtime container
START RequestId: e21526a5-9594-4d44-a8bb-112f4148e0ee Version: $LATEST
END RequestId: e21526a5-9594-4d44-a8bb-112f4148e0ee
REPORT RequestId: e21526a5-9594-4d44-a8bb-112f4148e0ee  Init Duration: 0.32 ms  Duration: 94.26 ms      Billed Duration: 95 ms  Memory Size: 128 MB     Max Memory Used: 128 MB
null%                                                                                   
```

There are several lines of note. 

* **START** provides the request ID and the invoked function version 

* **END** provides the request ID

* **REPORT** provides more information about the function invocation, including the

    * **RequestId** – The unique request ID for the invocation.

    * **Duration** – The amount of time that your function's handler method spent processing the event.

    * **Billed Duration** – The amount of time billed for the invocation.

    * **Memory Size** – The amount of memory allocated to the function.

    * **Max Memory Used** – The amount of memory used by the function.

    * **Init Duration** – For cold starts, the amount of time it took the runtime to load the function and run code outside of the handler method.

    * **XRAY TraceId** – For traced requests, the AWS X-Ray trace ID.

    * **SegmentId** – For traced requests, the X-Ray segment ID.

    * **Sampled** – For traced requests, the sampling result.

Now that we know what is logged by a function execution by default, let's log data from our function.

## Logging Application Data

Writing data in a Lambda function to `stdout` or `stderr` will cause the information to be logged. In python3, this is as simple as using the `print` method or as complex as using a a logging library like [logging](https://docs.python.org/3/library/logging.html).

Using the following commands, you can build and run the function locally.

```bash
cd ../logging
sam build --use-container
sam local invoke 
```

The function emits the following log entries.

**NOTE:** Your ouput is representative - your output will differ.

```bash
Invoking index.handler (python3.9)
Skip pulling image and use local one: public.ecr.aws/sam/emulation-python3.9:rapid-1.53.0-x86_64.

Mounting /path/to/lambda-logging-primerlambda-logging-primer/simple-function/logging/.aws-sam/build/LoggingFunction as /var/task:ro,delegated inside runtime container
START RequestId: 6d7ae754-df17-492c-90c8-b67009996b3d Version: $LATEST
Random number: 10
END RequestId: 6d7ae754-df17-492c-90c8-b67009996b3d
REPORT RequestId: 6d7ae754-df17-492c-90c8-b67009996b3d  Init Duration: 0.24 ms  Duration: 131.09 ms     Billed Duration: 132 ms Memory Size: 128 MB     Max Memory Used: 128 MB
null%                            
```

The **START**, **END**, and **REPORT** lines are still emitted, but there is a new line present that is generated by the `print` statement in `logging/index.py`.

# Implications

AWS Lambda makes it easy to capture application data. Developers can take advantage of existing tooling they may already employ and emit data into a durable log storage.

However, simply emitting data into logs does not make it as usable as it can be for understanding behavior or troubleshooting when problems occur. Next, [we will explore how developers can structure their log data](./deploy-structured.md) so it can be indexed, searched, and visualized using CloudWatch.
